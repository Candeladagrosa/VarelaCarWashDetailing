# Módulo de Reportes - Varela Car Wash

## Descripción

Módulo administrativo para generar y exportar reportes del sistema en formato Excel (.xlsx).

## Reportes Disponibles

### Fase 1 - Reportes Básicos de Exportación ✅

1. **Exportación de Productos**
   - Incluye: ID, Nombre, Descripción, Precio, Stock, Visibilidad, Estado, Fechas
   - Permiso requerido: `reportes.exportar_productos`

2. **Exportación de Servicios**
   - Incluye: ID, Nombre, Descripción, Precio, Duración, Visibilidad, Estado, Fechas
   - Permiso requerido: `reportes.exportar_servicios`

3. **Exportación de Turnos**
   - Incluye: ID, Cliente, Email, Servicio, Fecha, Hora, Estado, Precio, Notas
   - Permiso requerido: `reportes.exportar_turnos`

4. **Exportación de Pedidos**
   - Incluye: ID, Cliente, Email, Total, Estado, Fecha, Método de Pago, Cantidad de Items
   - Permiso requerido: `reportes.exportar_pedidos`

## Instalación

### 1. Dependencias

La librería `xlsx` ya fue instalada. Si necesitas reinstalarla:

```bash
npm install xlsx
```

### 2. Configurar Permisos en Supabase

Ejecuta el script SQL en el editor SQL de Supabase:

```sql
-- Archivo: sql/permisos_reportes.sql
```

1. Ve a Supabase Dashboard
2. Abre el "SQL Editor"
3. Ejecuta el contenido del archivo `sql/permisos_reportes.sql`
4. Verifica que se crearon los permisos correctamente

### 3. Archivos Creados

- `src/components/admin/ReportesAdmin.jsx` - Componente principal del módulo
- `src/lib/exportUtils.js` - Utilidades para exportar datos a Excel
- `sql/permisos_reportes.sql` - Script para crear permisos en la base de datos

### 4. Integración

El módulo ya está integrado en `AdminPanel.jsx` con:
- Tab "Reportes" con icono FileBarChart
- PermissionGuard para controlar acceso
- Icono visible solo para usuarios con permiso `reportes.ver_listado`

## Uso

1. Ingresa al Panel Administrativo
2. Haz clic en la pestaña "Reportes"
3. Selecciona el reporte que deseas exportar
4. Haz clic en "Exportar a Excel"
5. El archivo se descargará automáticamente con formato: `[Tipo]_YYYYMMDD_HHMMSS.xlsx`

## Permisos

El módulo utiliza los siguientes permisos:

- `reportes.ver_listado` - Acceso al módulo de reportes
- `reportes.exportar_productos` - Exportar productos
- `reportes.exportar_servicios` - Exportar servicios
- `reportes.exportar_turnos` - Exportar turnos
- `reportes.exportar_pedidos` - Exportar pedidos

Por defecto, todos los permisos se asignan al rol **Admin** (id_rol = 1).

## Características

✅ Exportación a formato Excel (.xlsx)
✅ Nombres de archivo con timestamp
✅ Columnas autoajustadas
✅ Formato de fechas argentino (es-AR)
✅ Protección por permisos
✅ Indicadores de carga
✅ Manejo de errores con toast notifications
✅ Diseño responsive
✅ Documentación completa con PHPDoc/JSDoc

## Próximas Fases

### Fase 2 - Reportes Analíticos (Pendiente)

- Turnos por día
- Turnos por servicio
- Ingresos por período
- Cantidad de unidades vendidas por producto en el mes

### Fase 3 - Reportes Avanzados (Pendiente)

- Análisis de clientes frecuentes
- Comparativas mes a mes
- Tasa de ocupación de turnos

## Tecnologías Utilizadas

- **React** - Framework principal
- **xlsx** - Generación de archivos Excel
- **Supabase** - Base de datos y autenticación
- **Framer Motion** - Animaciones
- **Lucide React** - Iconos
- **Tailwind CSS** - Estilos

## Soporte

Para reportar bugs o solicitar nuevas funcionalidades, contacta al equipo de desarrollo.
